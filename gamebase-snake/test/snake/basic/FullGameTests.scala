package snake.basic

import snake.logic.{East, North, South, West}
import snake.{ChangeDir, SnakeTestSuiteBase}

class FullGameTests extends SnakeTestSuiteBase {
    test("testGame3x1") {
        checkGame(
            List(
                TestFrame(0,
                    """OO>"""),
                TestFrame(0,
                    """>OO"""),
                TestFrame(0,
                    """O>O"""),
                TestFrame(0,
                    """OO>"""),
                TestFrame(0,
                    """>OO"""),
                TestFrame(0,
                    """O>O"""),
                TestFrame(0,
                    """OO>""")
            ), "The game should work at any board size which can hold the initial snake. In this case 3x1."
        )
    }

    val game6x6 : List[TestFrame] = List(
        TestFrame(2,
            """OO>..A
              |......
              |......
              |......
              |......
              |......"""),
        TestFrame(2,
            """.OO>.A
              |......
              |......
              |......
              |......
              |......"""),
        TestFrame(2,
            """..OO>A
              |......
              |......
              |......
              |......
              |......"""),
        TestFrame(2,
            """..AOO>
              |......
              |......
              |......
              |......
              |......"""),
        TestFrame(2,
            """>.AOOO
              |......
              |......
              |......
              |......
              |......"""),
        TestFrame(2,
            """O>AOOO
              |......
              |......
              |......
              |......
              |......"""),
        TestFrame(2,
            """OO>OOO
              |..A...
              |......
              |......
              |......
              |......"""),
        TestFrame(2, List(ChangeDir(South())),
            """OOOOOO
              |..vA..
              |......
              |......
              |......
              |......"""),
        TestFrame(2,
            """OOOOOO
              |..OA..
              |..v...
              |......
              |......
              |......"""),
        TestFrame(2, List(ChangeDir(West())),
            """OOOOOO
              |..OA..
              |.<O...
              |......
              |......
              |......"""),
        TestFrame(2, List(ChangeDir(North())),
            """OOOOOO
              |.^OA..
              |.OO...
              |......
              |......
              |......"""),
        TestFrame(2, List(ChangeDir(West())),
            """OOOOOO
              |<OOA..
              |.OO...
              |......
              |......
              |......"""),
        TestFrame(2,
            """OOOOOO
              |OOOA.<
              |.OO...
              |......
              |......
              |......"""),
        TestFrame(2,
            """OOO.OO
              |OOOA<O
              |.OO...
              |......
              |......
              |......"""),
        TestFrame(2,
            """OOO..O
              |OOO<OO
              |AOO...
              |......
              |......
              |......"""),
        TestFrame(2, List(ChangeDir(North())),
            """OOO^.O
              |OOOOOO
              |AOO...
              |......
              |......
              |......"""),
        TestFrame(2,
            """OOOO.O
              |OOOOOO
              |AOO...
              |......
              |......
              |...^.."""),
        TestFrame(2,
            """OOOO.O
              |OOOOOO
              |AOO...
              |......
              |...^..
              |...O.."""),
        TestFrame(2, List(ChangeDir(West())),
            """OOOO..
              |OOOOOO
              |AOO...
              |......
              |..<O..
              |...O.."""),
        TestFrame(2,
            """.OOO..
              |OOOOOO
              |AOO...
              |......
              |.<OO..
              |...O.."""),
        TestFrame(2,
            """..OO..
              |OOOOOO
              |AOO...
              |......
              |<OOO..
              |...O.."""),
        TestFrame(2, List(ChangeDir(North())),
            """...O..
              |OOOOOO
              |AOO...
              |^.....
              |OOOO..
              |...O.."""),
        TestFrame(2,
            """..AO..
              |OO.OOO
              |^OO...
              |O.....
              |OOOO..
              |...O.."""),
        TestFrame(2, List(ChangeDir(West())),
            """..AO..
              |OO.OOO
              |OOO..<
              |O.....
              |OOOO..
              |...O.."""),
        TestFrame(2,
            """..AO..
              |OO.OOO
              |OOO.<O
              |O.....
              |OOOO..
              |...O.."""),
        TestFrame(2, List(ChangeDir(South())),
            """..AO..
              |OO.OOO
              |OOO.OO
              |O...v.
              |OOOO..
              |...O.."""),
        TestFrame(2, List(ChangeDir(East())),
            """..AO..
              |OO.OOO
              |OO..OO
              |O...O>
              |OOOO..
              |...O.."""),
        TestFrame(2,
            GameOverDisplay()),
    )

    test("testGame6x6") {
        checkGame(game6x6, hint ="The game should work at any board size which can hold the initial snake. In this case 6x6.")
    }

    val game6x3 : List[TestFrame] =   List(
        TestFrame(2,
            """OO>..A
              |......
              |......"""),
        TestFrame(2,
            """.OO>.A
              |......
              |......"""),
        TestFrame(2,
            """..OO>A
              |......
              |......"""),
        TestFrame(2,
            """..AOO>
              |......
              |......"""),
        TestFrame(2,
            """>.AOOO
              |......
              |......"""),
        TestFrame(2,
            """O>AOOO
              |......
              |......"""),
        TestFrame(2,
            """OO>OOO
              |..A...
              |......"""),
        TestFrame(2, List(ChangeDir(North())),
            """OOOOOO
              |..A...
              |..^..."""),
        TestFrame(2,
            """OOOOOO
              |..^A..
              |..O..."""),
        TestFrame(2, List(ChangeDir(West())),
            """OOOOOO
              |.<OA..
              |..O..."""),
        TestFrame(2,
            """OOOOOO
              |<OOA..
              |..O..."""),
        TestFrame(2,
            """OOOOOO
              |OOOA.<
              |..O..."""),
        TestFrame(2,
            """OOOOOO
              |OOOA<O
              |..O..."""),
        TestFrame(2,
            """OOO.OO
              |OOO<OO
              |.AO..."""),
        TestFrame(2, List(ChangeDir(South())),
            """OOO.OO
              |OOOOOO
              |.AOv.."""),
        TestFrame(2, List(ChangeDir(East())),
            """OOO.OO
              |OOOOOO
              |.AOO>."""),
        TestFrame(2,
            """OOO.OO
              |OOOOOO
              |.AOOO>"""),
        TestFrame(2,
            """OOO..O
              |OOOOOO
              |>AOOOO"""),
        TestFrame(2,
            """OOO..A
              |OOOOOO
              |O>OOOO"""),
        TestFrame(2,
            GameOverDisplay())
    )

    test("testGame6x3") {
        checkGame(game6x3, hint = "The game should work at any board size which can hold the initial snake. In this case 6x3." )
    }

    val game10x7 : List[TestFrame] =  List(
        TestFrame(2,
            """OO>..A....
              |..........
              |..........
              |..........
              |..........
              |..........
              |.........."""),
        TestFrame(2,
            """.OO>.A....
              |..........
              |..........
              |..........
              |..........
              |..........
              |.........."""),
        TestFrame(2,
            """..OO>A....
              |..........
              |..........
              |..........
              |..........
              |..........
              |.........."""),
        TestFrame(2,
            """..AOO>....
              |..........
              |..........
              |..........
              |..........
              |..........
              |.........."""),
        TestFrame(2,
            """..AOOO>...
              |..........
              |..........
              |..........
              |..........
              |..........
              |.........."""),
        TestFrame(2,
            """..AOOOO>..
              |..........
              |..........
              |..........
              |..........
              |..........
              |.........."""),
        TestFrame(2,
            """..AOOOOO>.
              |..........
              |..........
              |..........
              |..........
              |..........
              |.........."""),
        TestFrame(2,
            """..A.OOOOO>
              |..........
              |..........
              |..........
              |..........
              |..........
              |.........."""),
        TestFrame(2,
            """>.A..OOOOO
              |..........
              |..........
              |..........
              |..........
              |..........
              |.........."""),
        TestFrame(2,
            """O>A...OOOO
              |..........
              |..........
              |..........
              |..........
              |..........
              |.........."""),
        TestFrame(2,
            """OO>..A.OOO
              |..........
              |..........
              |..........
              |..........
              |..........
              |.........."""),
        TestFrame(2,
            """OOO>.A.OOO
              |..........
              |..........
              |..........
              |..........
              |..........
              |.........."""),
        TestFrame(2,
            """OOOO>A.OOO
              |..........
              |..........
              |..........
              |..........
              |..........
              |.........."""),
        TestFrame(2,
            """OOOOO>.OOO
              |.A........
              |..........
              |..........
              |..........
              |..........
              |.........."""),
        TestFrame(2,
            """OOOOOO>OOO
              |.A........
              |..........
              |..........
              |..........
              |..........
              |.........."""),
        TestFrame(2, List(ChangeDir(North())),
            """OOOOOOOOOO
              |.A........
              |..........
              |..........
              |..........
              |..........
              |......^..."""),
        TestFrame(2,
            """OOOOOOOOOO
              |.A........
              |..........
              |..........
              |..........
              |......^...
              |......O..."""),
        TestFrame(2, List(ChangeDir(East())),
            """OOOOOOO.OO
              |.A........
              |..........
              |..........
              |..........
              |......O>..
              |......O..."""),
        TestFrame(2,
            """OOOOOOO..O
              |.A........
              |..........
              |..........
              |..........
              |......OO>.
              |......O..."""),
        TestFrame(2,
            """OOOOOOO...
              |.A........
              |..........
              |..........
              |..........
              |......OOO>
              |......O..."""),
        TestFrame(2,
            """.OOOOOO...
              |.A........
              |..........
              |..........
              |..........
              |>.....OOOO
              |......O..."""),
        TestFrame(2,
            """..OOOOO...
              |.A........
              |..........
              |..........
              |..........
              |O>....OOOO
              |......O..."""),
        TestFrame(2,
            """...OOOO...
              |.A........
              |..........
              |..........
              |..........
              |OO>...OOOO
              |......O..."""),
        TestFrame(2,
            """....OOO...
              |.A........
              |..........
              |..........
              |..........
              |OOO>..OOOO
              |......O..."""),
        TestFrame(2,
            """.....OO...
              |.A........
              |..........
              |..........
              |..........
              |OOOO>.OOOO
              |......O..."""),
        TestFrame(2, List(ChangeDir(North())),
            """......O...
              |.A........
              |..........
              |..........
              |....^.....
              |OOOOO.OOOO
              |......O..."""),
        TestFrame(2,
            """..........
              |.A........
              |..........
              |....^.....
              |....O.....
              |OOOOO.OOOO
              |......O..."""),
        TestFrame(2,
            """..........
              |.A........
              |....^.....
              |....O.....
              |....O.....
              |OOOOO.OOOO
              |.........."""),
        TestFrame(2,
            """..........
              |.A..^.....
              |....O.....
              |....O.....
              |....O.....
              |OOOOO..OOO
              |.........."""),
        TestFrame(2, List(ChangeDir(West())),
            """..........
              |.A.<O.....
              |....O.....
              |....O.....
              |....O.....
              |OOOOO...OO
              |.........."""),
        TestFrame(2,
            """..........
              |.A<OO.....
              |....O.....
              |....O.....
              |....O.....
              |OOOOO....O
              |.........."""),
        TestFrame(2,
            """..A.......
              |.<OOO.....
              |....O.....
              |....O.....
              |....O.....
              |OOOOO.....
              |.........."""),
        TestFrame(2,
            """..A.......
              |<OOOO.....
              |....O.....
              |....O.....
              |....O.....
              |OOOOO.....
              |.........."""),
        TestFrame(2,
            """..A.......
              |OOOOO....<
              |....O.....
              |....O.....
              |....O.....
              |OOOOO.....
              |.........."""),
        TestFrame(2,
            """..A.......
              |OOOOO...<O
              |....O.....
              |....O.....
              |....O.....
              |OOOOO.....
              |.........."""),
        TestFrame(2, List(ChangeDir(South())),
            """..A.......
              |OOOOO...OO
              |....O...v.
              |....O.....
              |....O.....
              |.OOOO.....
              |.........."""),
        TestFrame(2,
            """..A.......
              |OOOOO...OO
              |....O...O.
              |....O...v.
              |....O.....
              |..OOO.....
              |.........."""),
        TestFrame(2,
            """..A.......
              |OOOOO...OO
              |....O...O.
              |....O...O.
              |....O...v.
              |...OO.....
              |.........."""),
        TestFrame(2,
            """..A.......
              |OOOOO...OO
              |....O...O.
              |....O...O.
              |....O...O.
              |....O...v.
              |.........."""),
        TestFrame(2,
            """..A.......
              |OOOOO...OO
              |....O...O.
              |....O...O.
              |....O...O.
              |........O.
              |........v."""),
        TestFrame(2,
            """..A.....v.
              |OOOOO...OO
              |....O...O.
              |....O...O.
              |........O.
              |........O.
              |........O."""),
        TestFrame(2, List(ChangeDir(West())),
            """..A....<O.
              |OOOOO...OO
              |....O...O.
              |........O.
              |........O.
              |........O.
              |........O."""),
        TestFrame(2,
            """..A...<OO.
              |OOOOO...OO
              |........O.
              |........O.
              |........O.
              |........O.
              |........O."""),
        TestFrame(2,
            """..A..<OOO.
              |OOOO....OO
              |........O.
              |........O.
              |........O.
              |........O.
              |........O."""),
        TestFrame(2,
            """..A.<OOOO.
              |OOO.....OO
              |........O.
              |........O.
              |........O.
              |........O.
              |........O."""),
        TestFrame(2,
            """..A<OOOOO.
              |OO......OO
              |........O.
              |........O.
              |........O.
              |........O.
              |........O."""),
        TestFrame(2,
            """..<OOOOOOA
              |O.......OO
              |........O.
              |........O.
              |........O.
              |........O.
              |........O."""),
        TestFrame(2,
            """.<OOOOOOOA
              |O.......OO
              |........O.
              |........O.
              |........O.
              |........O.
              |........O."""),
        TestFrame(2, List(ChangeDir(North())),
            """.OOOOOOOOA
              |O.......OO
              |........O.
              |........O.
              |........O.
              |........O.
              |.^......O."""),
        TestFrame(2,
            """.OOOOOOOOA
              |O.......OO
              |........O.
              |........O.
              |........O.
              |.^......O.
              |.O......O."""),
        TestFrame(2,
            """.OOOOOOOOA
              |........OO
              |........O.
              |........O.
              |.^......O.
              |.O......O.
              |.O......O."""),
        TestFrame(2,
            """.OOOOOOOOA
              |........O.
              |........O.
              |.^......O.
              |.O......O.
              |.O......O.
              |.O......O."""),
        TestFrame(2,
            """.OOOOOOOOA
              |..........
              |.^......O.
              |.O......O.
              |.O......O.
              |.O......O.
              |.O......O."""),
        TestFrame(2,
            """.OOOOOOOOA
              |.^........
              |.O........
              |.O......O.
              |.O......O.
              |.O......O.
              |.O......O."""),
        TestFrame(2,
            GameOverDisplay())
    )

    test("testGame10x7") {
        checkGame( game10x7,  hint ="The game should work at any board size which can hold the initial snake. In this case 10x7.")
    }

    test("testInterleave6x3and10x7") {
        checkInterleave(game6x3,game10x7)
    }

    test("testInterleave6x6and10x7") {
        checkInterleave(game6x6,game10x7)
    }


    test("testInterleave6x3and6x6") {
        checkInterleave(game6x3,game6x6)
    }
}
